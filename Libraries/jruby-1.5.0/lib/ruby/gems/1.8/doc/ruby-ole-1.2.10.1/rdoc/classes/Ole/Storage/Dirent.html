<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: Ole::Storage::Dirent</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">Ole::Storage::Dirent</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../../files/lib/ole/storage/base_rb.html">
                lib/ole/storage/base.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                Struct.new(         :name_utf16, :name_len, :type_id, :colour, :prev, :next, :child,         :clsid, :flags,
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
A class which wraps an ole directory entry. Can be either a directory
(<tt>Dirent#dir?</tt>) or a file (<tt>Dirent#file?</tt>)
</p>
<p>
Most interaction with <tt><a href="../Storage.html">Ole::Storage</a></tt>
is through this class. The 2 most important functions are
<tt>Dirent#children</tt>, and <tt>Dirent#data</tt>.
</p>
<p>
was considering separate classes for dirs and files. some methods/attrs
only applicable to one or the other.
</p>
<p>
As with the other classes, <a href="Dirent.html#M000169">to_s</a> performs
the serialization.
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000163">/</a>&nbsp;&nbsp;
      <a href="#M000171">&lt;&lt;</a>&nbsp;&nbsp;
      <a href="#M000164">[]</a>&nbsp;&nbsp;
      <a href="#M000158">children=</a>&nbsp;&nbsp;
      <a href="#M000173">copy</a>&nbsp;&nbsp;
      <a href="#M000172">delete</a>&nbsp;&nbsp;
      <a href="#M000162">dir?</a>&nbsp;&nbsp;
      <a href="#M000166">each_child</a>&nbsp;&nbsp;
      <a href="#M000161">file?</a>&nbsp;&nbsp;
      <a href="#M000167">flatten</a>&nbsp;&nbsp;
      <a href="#M000168">flatten_helper</a>&nbsp;&nbsp;
      <a href="#M000170">inspect</a>&nbsp;&nbsp;
      <a href="#M000157">name=</a>&nbsp;&nbsp;
      <a href="#M000156">new</a>&nbsp;&nbsp;
      <a href="#M000159">open</a>&nbsp;&nbsp;
      <a href="#M000160">read</a>&nbsp;&nbsp;
      <a href="#M000165">time</a>&nbsp;&nbsp;
      <a href="#M000169">to_s</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->
    <div id="includes">
      <h3 class="section-bar">Included Modules</h3>

      <div id="includes-list">
        <span class="include-name">RecursivelyEnumerable</span>
      </div>
    </div>

    <div id="section">


    <div id="constants-list">
      <h3 class="section-bar">Constants</h3>

      <div class="name-list">
        <table summary="Constants">
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">PACK</td>
          <td>=</td>
          <td class="context-item-value">'a64 v C C V3 a16 V a8 a8 V2 a4'</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">SIZE</td>
          <td>=</td>
          <td class="context-item-value">128</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">TYPE_MAP</td>
          <td>=</td>
          <td class="context-item-value">{         # this is temporary         0 =&gt; :empty,         1 =&gt; :dir,         2 =&gt; :file,         5 =&gt; :root</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">COLOUR_MAP</td>
          <td>=</td>
          <td class="context-item-value">{         0 =&gt; :red,         1 =&gt; :black</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
something to do with the fact that the tree is supposed to be red-black

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">EOT</td>
          <td>=</td>
          <td class="context-item-value">0xffffffff</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
used in the next / prev / child stuff to show that the tree ends here. also
used for first_block for directory.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">DEFAULT</td>
          <td>=</td>
          <td class="context-item-value">[         0.chr * 2, 2, 0, # will get overwritten         1, EOT, EOT, EOT,         0.chr * 16, 0, nil, nil,         AllocationTable::EOC, 0, 0.chr * 4</td>
        </tr>
        </table>
      </div>
    </div>



    <div id="attribute-list">
      <h3 class="section-bar">Attributes</h3>

      <div class="name-list">
        <table>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">children</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
This returns all the children of this <tt><a
href="Dirent.html">Dirent</a></tt>. It is filled in when the tree structure
is recreated.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">create_time</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">idx</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc">
i think its just used by the tree building

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">modify_time</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">name</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">name_lookup</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
these are for internal use and are used for faster lookup.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">ole</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">parent</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">parent</td>
          <td class="context-item-value">&nbsp;[W]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">type</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        </table>
      </div>
    </div>
      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000173" class="method-detail">
        <a name="M000173"></a>

        <div class="method-heading">
          <a href="Dirent.src/M000173.html" target="Code" class="method-signature"
            onclick="popupCode('Dirent.src/M000173.html');return false;">
          <span class="method-name">copy</span><span class="method-args">(src, dst)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000168" class="method-detail">
        <a name="M000168"></a>

        <div class="method-heading">
          <a href="Dirent.src/M000168.html" target="Code" class="method-signature"
            onclick="popupCode('Dirent.src/M000168.html');return false;">
          <span class="method-name">flatten_helper</span><span class="method-args">(children)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
i think making the tree structure optimized is actually more complex than
this, and requires some intelligent ordering of the children based on
names, but as long as it is valid its ok. actually, i think its ok. gsf for
example only outputs a singly-linked-list, where prev is always EOT.
</p>
        </div>
      </div>

      <div id="method-M000156" class="method-detail">
        <a name="M000156"></a>

        <div class="method-heading">
          <a href="Dirent.src/M000156.html" target="Code" class="method-signature"
            onclick="popupCode('Dirent.src/M000156.html');return false;">
          <span class="method-name">new</span><span class="method-args">(ole, values=DEFAULT, params={})</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000163" class="method-detail">
        <a name="M000163"></a>

        <div class="method-heading">
          <a href="Dirent.src/M000163.html" target="Code" class="method-signature"
            onclick="popupCode('Dirent.src/M000163.html');return false;">
          <span class="method-name">/</span><span class="method-args">(name)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
maybe need some options regarding case sensitivity.
</p>
        </div>
      </div>

      <div id="method-M000171" class="method-detail">
        <a name="M000171"></a>

        <div class="method-heading">
          <a href="Dirent.src/M000171.html" target="Code" class="method-signature"
            onclick="popupCode('Dirent.src/M000171.html');return false;">
          <span class="method-name">&lt;&lt;</span><span class="method-args">(child)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000164" class="method-detail">
        <a name="M000164"></a>

        <div class="method-heading">
          <a href="Dirent.src/M000164.html" target="Code" class="method-signature"
            onclick="popupCode('Dirent.src/M000164.html');return false;">
          <span class="method-name">[]</span><span class="method-args">(idx)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000158" class="method-detail">
        <a name="M000158"></a>

        <div class="method-heading">
          <a href="Dirent.src/M000158.html" target="Code" class="method-signature"
            onclick="popupCode('Dirent.src/M000158.html');return false;">
          <span class="method-name">children=</span><span class="method-args">(children)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000172" class="method-detail">
        <a name="M000172"></a>

        <div class="method-heading">
          <a href="Dirent.src/M000172.html" target="Code" class="method-signature"
            onclick="popupCode('Dirent.src/M000172.html');return false;">
          <span class="method-name">delete</span><span class="method-args">(child, truncate=true)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
remove the <a href="Dirent.html">Dirent</a> <tt>child</tt> from the
children array, truncating the data by default.
</p>
        </div>
      </div>

      <div id="method-M000162" class="method-detail">
        <a name="M000162"></a>

        <div class="method-heading">
          <a href="Dirent.src/M000162.html" target="Code" class="method-signature"
            onclick="popupCode('Dirent.src/M000162.html');return false;">
          <span class="method-name">dir?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000166" class="method-detail">
        <a name="M000166"></a>

        <div class="method-heading">
          <a href="Dirent.src/M000166.html" target="Code" class="method-signature"
            onclick="popupCode('Dirent.src/M000166.html');return false;">
          <span class="method-name">each_child</span><span class="method-args">(&amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000161" class="method-detail">
        <a name="M000161"></a>

        <div class="method-heading">
          <a href="Dirent.src/M000161.html" target="Code" class="method-signature"
            onclick="popupCode('Dirent.src/M000161.html');return false;">
          <span class="method-name">file?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000167" class="method-detail">
        <a name="M000167"></a>

        <div class="method-heading">
          <a href="Dirent.src/M000167.html" target="Code" class="method-signature"
            onclick="popupCode('Dirent.src/M000167.html');return false;">
          <span class="method-name">flatten</span><span class="method-args">(dirents=[])</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
flattens the tree starting from here into <tt>dirents</tt>. note it
modifies its argument.
</p>
        </div>
      </div>

      <div id="method-M000170" class="method-detail">
        <a name="M000170"></a>

        <div class="method-heading">
          <a href="Dirent.src/M000170.html" target="Code" class="method-signature"
            onclick="popupCode('Dirent.src/M000170.html');return false;">
          <span class="method-name">inspect</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000157" class="method-detail">
        <a name="M000157"></a>

        <div class="method-heading">
          <a href="Dirent.src/M000157.html" target="Code" class="method-signature"
            onclick="popupCode('Dirent.src/M000157.html');return false;">
          <span class="method-name">name=</span><span class="method-args">(name)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000159" class="method-detail">
        <a name="M000159"></a>

        <div class="method-heading">
          <a href="Dirent.src/M000159.html" target="Code" class="method-signature"
            onclick="popupCode('Dirent.src/M000159.html');return false;">
          <span class="method-name">open</span><span class="method-args">(mode='r') {|io| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000160" class="method-detail">
        <a name="M000160"></a>

        <div class="method-heading">
          <a href="Dirent.src/M000160.html" target="Code" class="method-signature"
            onclick="popupCode('Dirent.src/M000160.html');return false;">
          <span class="method-name">read</span><span class="method-args">(limit=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000165" class="method-detail">
        <a name="M000165"></a>

        <div class="method-heading">
          <a href="Dirent.src/M000165.html" target="Code" class="method-signature"
            onclick="popupCode('Dirent.src/M000165.html');return false;">
          <span class="method-name">time</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
move to ruby-msg. and remove from here
</p>
        </div>
      </div>

      <div id="method-M000169" class="method-detail">
        <a name="M000169"></a>

        <div class="method-heading">
          <a href="Dirent.src/M000169.html" target="Code" class="method-signature"
            onclick="popupCode('Dirent.src/M000169.html');return false;">
          <span class="method-name">to_s</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>