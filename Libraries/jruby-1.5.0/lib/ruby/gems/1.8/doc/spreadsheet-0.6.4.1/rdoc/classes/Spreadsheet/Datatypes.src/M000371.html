<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html>
<head>
  <title>append_features (Spreadsheet::Datatypes)</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <link rel="stylesheet" href="../../.././rdoc-style.css" type="text/css" media="screen" />
</head>
<body class="standalone-code">
  <pre><span class="ruby-comment cmt"># File lib/spreadsheet/datatypes.rb, line 9</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-constant">Datatypes</span>.<span class="ruby-identifier">append_features</span> <span class="ruby-identifier">mod</span>
      <span class="ruby-keyword kw">super</span>
      <span class="ruby-identifier">mod</span>.<span class="ruby-identifier">module_eval</span> <span class="ruby-keyword kw">do</span>
<span class="ruby-keyword kw">class</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-keyword kw">self</span>
  <span class="ruby-comment cmt">##</span>
  <span class="ruby-comment cmt"># Valid colors for color attributes.</span>
  <span class="ruby-constant">COLORS</span> = [ <span class="ruby-identifier">:builtin_black</span>, <span class="ruby-identifier">:builtin_white</span>, <span class="ruby-identifier">:builtin_red</span>, <span class="ruby-identifier">:builtin_green</span>,
             <span class="ruby-identifier">:builtin_blue</span>, <span class="ruby-identifier">:builtin_yellow</span>, <span class="ruby-identifier">:builtin_magenta</span>, <span class="ruby-identifier">:builtin_cyan</span>,
             <span class="ruby-identifier">:text</span>, <span class="ruby-identifier">:border</span>, <span class="ruby-identifier">:pattern_bg</span>, <span class="ruby-identifier">:dialog_bg</span>, <span class="ruby-identifier">:chart_text</span>, <span class="ruby-identifier">:chart_bg</span>,
             <span class="ruby-identifier">:chart_border</span>, <span class="ruby-identifier">:tooltip_bg</span>, <span class="ruby-identifier">:tooltip_text</span>, <span class="ruby-identifier">:aqua</span>,
             <span class="ruby-identifier">:black</span>, <span class="ruby-identifier">:blue</span>, <span class="ruby-identifier">:cyan</span>, <span class="ruby-identifier">:brown</span>, <span class="ruby-identifier">:fuchsia</span>, <span class="ruby-identifier">:gray</span>, <span class="ruby-identifier">:grey</span>, <span class="ruby-identifier">:green</span>,
             <span class="ruby-identifier">:lime</span>, <span class="ruby-identifier">:magenta</span>, <span class="ruby-identifier">:navy</span>, <span class="ruby-identifier">:orange</span>, <span class="ruby-identifier">:purple</span>, <span class="ruby-identifier">:red</span>, <span class="ruby-identifier">:silver</span>, <span class="ruby-identifier">:white</span>,
             <span class="ruby-identifier">:yellow</span> ]
  <span class="ruby-comment cmt">##</span>
  <span class="ruby-comment cmt"># Define instance methods to read and write boolean attributes.</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">boolean</span> <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>
    <span class="ruby-identifier">args</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">define_method</span> <span class="ruby-identifier">key</span> <span class="ruby-keyword kw">do</span>
        <span class="ruby-identifier">name</span> = <span class="ruby-identifier">ivar_name</span> <span class="ruby-identifier">key</span>
        <span class="ruby-operator">!</span><span class="ruby-operator">!</span>(<span class="ruby-identifier">instance_variable_get</span>(<span class="ruby-identifier">name</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">instance_variables</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">name</span>))
      <span class="ruby-keyword kw">end</span>
      <span class="ruby-identifier">define_method</span> <span class="ruby-node">&quot;#{key}?&quot;</span> <span class="ruby-keyword kw">do</span>
        <span class="ruby-identifier">send</span> <span class="ruby-identifier">key</span>
      <span class="ruby-keyword kw">end</span>
      <span class="ruby-identifier">define_method</span> <span class="ruby-node">&quot;#{key}=&quot;</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">arg</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">arg</span> = <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">arg</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
        <span class="ruby-identifier">instance_variable_set</span>(<span class="ruby-identifier">ivar_name</span>(<span class="ruby-identifier">key</span>), <span class="ruby-operator">!</span><span class="ruby-operator">!</span><span class="ruby-identifier">arg</span>)
      <span class="ruby-keyword kw">end</span>
      <span class="ruby-identifier">define_method</span> <span class="ruby-node">&quot;#{key}!&quot;</span> <span class="ruby-keyword kw">do</span>
        <span class="ruby-identifier">send</span> <span class="ruby-node">&quot;#{key}=&quot;</span>, <span class="ruby-keyword kw">true</span>
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">end</span>
  <span class="ruby-comment cmt">##</span>
  <span class="ruby-comment cmt"># Define instance methods to read and write color attributes.</span>
  <span class="ruby-comment cmt"># For valid colors see COLORS</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">colors</span> <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>
    <span class="ruby-identifier">args</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">attr_reader</span> <span class="ruby-identifier">key</span>
      <span class="ruby-identifier">define_method</span> <span class="ruby-node">&quot;#{key}=&quot;</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">name</span> = <span class="ruby-identifier">name</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">downcase</span>.<span class="ruby-identifier">to_sym</span>
        <span class="ruby-keyword kw">if</span> <span class="ruby-constant">COLORS</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">name</span>)
          <span class="ruby-identifier">instance_variable_set</span> <span class="ruby-identifier">ivar_name</span>(<span class="ruby-identifier">key</span>), <span class="ruby-identifier">name</span>
        <span class="ruby-keyword kw">else</span>
          <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-node">&quot;unknown color '#{name}'&quot;</span>
        <span class="ruby-keyword kw">end</span>
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">end</span>
  <span class="ruby-comment cmt">##</span>
  <span class="ruby-comment cmt"># Define instance methods to read and write enumeration attributes.</span>
  <span class="ruby-comment cmt"># * The first argument designates the attribute name.</span>
  <span class="ruby-comment cmt"># * The second argument designates the default value.</span>
  <span class="ruby-comment cmt"># * All subsequent attributes are possible values.</span>
  <span class="ruby-comment cmt"># * If the last attribute is a Hash, each value in the Hash designates</span>
  <span class="ruby-comment cmt">#   aliases for the corresponding key.</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">enum</span> <span class="ruby-identifier">key</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">values</span>
    <span class="ruby-identifier">aliases</span> = {}
    <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">values</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">Hash</span>
      <span class="ruby-identifier">values</span>.<span class="ruby-identifier">pop</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">value</span>, <span class="ruby-identifier">synonyms</span><span class="ruby-operator">|</span>
        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">synonyms</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">Array</span>
          <span class="ruby-identifier">synonyms</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">synonym</span><span class="ruby-operator">|</span> <span class="ruby-identifier">aliases</span>.<span class="ruby-identifier">store</span> <span class="ruby-identifier">synonym</span>, <span class="ruby-identifier">value</span> <span class="ruby-keyword kw">end</span>
        <span class="ruby-keyword kw">else</span>
          <span class="ruby-identifier">aliases</span>.<span class="ruby-identifier">store</span> <span class="ruby-identifier">synonyms</span>, <span class="ruby-identifier">value</span>
        <span class="ruby-keyword kw">end</span>
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">end</span>
    <span class="ruby-identifier">values</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">aliases</span>.<span class="ruby-identifier">store</span> <span class="ruby-identifier">value</span>, <span class="ruby-identifier">value</span>
    <span class="ruby-keyword kw">end</span>
    <span class="ruby-identifier">define_method</span> <span class="ruby-identifier">key</span> <span class="ruby-keyword kw">do</span>
      <span class="ruby-identifier">name</span> = <span class="ruby-identifier">ivar_name</span> <span class="ruby-identifier">key</span>
      <span class="ruby-identifier">value</span> = <span class="ruby-identifier">instance_variable_get</span>(<span class="ruby-identifier">name</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">instance_variables</span>.<span class="ruby-identifier">include?</span> <span class="ruby-identifier">name</span>
      <span class="ruby-identifier">value</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">values</span>.<span class="ruby-identifier">first</span>
    <span class="ruby-keyword kw">end</span>
    <span class="ruby-identifier">define_method</span> <span class="ruby-node">&quot;#{key}=&quot;</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">arg</span><span class="ruby-operator">|</span>
      <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">arg</span>
        <span class="ruby-identifier">arg</span> = <span class="ruby-identifier">aliases</span>.<span class="ruby-identifier">fetch</span> <span class="ruby-identifier">arg</span> <span class="ruby-keyword kw">do</span>
          <span class="ruby-identifier">aliases</span>.<span class="ruby-identifier">fetch</span> <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">downcase</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/[ \-]/</span>, <span class="ruby-value str">'_'</span>).<span class="ruby-identifier">to_sym</span>, <span class="ruby-identifier">arg</span>
        <span class="ruby-keyword kw">end</span>
        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">values</span>.<span class="ruby-identifier">any?</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">val</span><span class="ruby-operator">|</span> <span class="ruby-identifier">val</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">arg</span> <span class="ruby-keyword kw">end</span>
          <span class="ruby-identifier">instance_variable_set</span>(<span class="ruby-identifier">ivar_name</span>(<span class="ruby-identifier">key</span>), <span class="ruby-identifier">arg</span>)
        <span class="ruby-keyword kw">else</span>
          <span class="ruby-identifier">valid</span> = <span class="ruby-identifier">values</span>.<span class="ruby-identifier">collect</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">val</span><span class="ruby-operator">|</span> <span class="ruby-identifier">val</span>.<span class="ruby-identifier">inspect</span> <span class="ruby-keyword kw">end</span>.<span class="ruby-identifier">join</span> <span class="ruby-value str">', '</span>
          <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>,
            <span class="ruby-node">&quot;Invalid value '#{arg.inspect}' for #{key}. Valid values are: #{valid}&quot;</span>
        <span class="ruby-keyword kw">end</span>
      <span class="ruby-keyword kw">else</span>
        <span class="ruby-identifier">instance_variable_set</span> <span class="ruby-identifier">ivar_name</span>(<span class="ruby-identifier">key</span>), <span class="ruby-identifier">values</span>.<span class="ruby-identifier">first</span>
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">end</span>
<span class="ruby-keyword kw">end</span>
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">end</span></pre>
</body>
</html>