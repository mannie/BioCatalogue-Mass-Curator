<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html>
<head>
  <title>write_xf (Spreadsheet::Excel::Writer::Format)</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <link rel="stylesheet" href="../../../../.././rdoc-style.css" type="text/css" media="screen" />
</head>
<body class="standalone-code">
  <pre><span class="ruby-comment cmt"># File lib/spreadsheet/excel/writer/format.rb, line 65</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">write_xf</span> <span class="ruby-identifier">writer</span>, <span class="ruby-identifier">type</span>=<span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:type</span>]
    <span class="ruby-identifier">xf_type</span> = <span class="ruby-identifier">xf_type_prot</span> <span class="ruby-identifier">type</span>
    <span class="ruby-identifier">data</span> = [
      <span class="ruby-identifier">font_index</span>,   <span class="ruby-comment cmt"># Index to FONT record (➜ 6.43)</span>
      <span class="ruby-identifier">num_format</span>,   <span class="ruby-comment cmt"># Index to FORMAT record (➜ 6.45)</span>
      <span class="ruby-identifier">xf_type</span>,      <span class="ruby-comment cmt">#  Bit  Mask    Contents</span>
                    <span class="ruby-comment cmt">#  2-0  0x0007  XF_TYPE_PROT – XF type, cell protection</span>
                    <span class="ruby-comment cmt">#               Bit  Mask  Contents</span>
                    <span class="ruby-comment cmt">#                 0  0x01  1 = Cell is locked</span>
                    <span class="ruby-comment cmt">#                 1  0x02  1 = Formula is hidden</span>
                    <span class="ruby-comment cmt">#                 2  0x04  0 = Cell XF; 1 = Style XF</span>
                    <span class="ruby-comment cmt"># 15-4  0xfff0  Index to parent style XF</span>
                    <span class="ruby-comment cmt">#               (always 0xfff in style XFs)</span>
      <span class="ruby-identifier">xf_align</span>,     <span class="ruby-comment cmt">#  Bit  Mask    Contents</span>
                    <span class="ruby-comment cmt">#  2-0  0x07    XF_HOR_ALIGN – Horizontal alignment</span>
                    <span class="ruby-comment cmt">#               Value  Horizontal alignment</span>
                    <span class="ruby-comment cmt">#               0x00   General</span>
                    <span class="ruby-comment cmt">#               0x01   Left</span>
                    <span class="ruby-comment cmt">#               0x02   Centred</span>
                    <span class="ruby-comment cmt">#               0x03   Right</span>
                    <span class="ruby-comment cmt">#               0x04   Filled</span>
                    <span class="ruby-comment cmt">#               0x05   Justified (BIFF4-BIFF8X)</span>
                    <span class="ruby-comment cmt">#               0x06   Centred across selection</span>
                    <span class="ruby-comment cmt">#                      (BIFF4-BIFF8X)</span>
                    <span class="ruby-comment cmt">#               0x07   Distributed (BIFF8X)</span>
                    <span class="ruby-comment cmt">#    3  0x08    1 = Text is wrapped at right border</span>
                    <span class="ruby-comment cmt">#  6-4  0x70    XF_VERT_ALIGN – Vertical alignment</span>
                    <span class="ruby-comment cmt">#               Value  Vertical alignment</span>
                    <span class="ruby-comment cmt">#               0x00   Top</span>
                    <span class="ruby-comment cmt">#               0x01   Centred</span>
                    <span class="ruby-comment cmt">#               0x02   Bottom</span>
                    <span class="ruby-comment cmt">#               0x03   Justified (BIFF5-BIFF8X)</span>
                    <span class="ruby-comment cmt">#               0x04   Distributed (BIFF8X)</span>
      <span class="ruby-identifier">xf_rotation</span>,  <span class="ruby-comment cmt"># XF_ROTATION:  Text rotation angle</span>
                    <span class="ruby-comment cmt">#  Value  Text rotation</span>
                    <span class="ruby-comment cmt">#      0  Not rotated</span>
                    <span class="ruby-comment cmt">#   1-90  1 to 90 degrees counterclockwise</span>
                    <span class="ruby-comment cmt"># 91-180  1 to 90 degrees clockwise</span>
                    <span class="ruby-comment cmt">#    255  Letters are stacked top-to-bottom,</span>
                    <span class="ruby-comment cmt">#         but not rotated</span>
      <span class="ruby-identifier">xf_indent</span>,    <span class="ruby-comment cmt">#  Bit  Mask  Contents</span>
                    <span class="ruby-comment cmt">#  3-0  0x0f  Indent level</span>
                    <span class="ruby-comment cmt">#    4  0x10  1 = Shrink content to fit into cell</span>
                    <span class="ruby-comment cmt">#    5  0x40  1 = Merge Range (djberger)</span>
                    <span class="ruby-comment cmt">#  7-6  0xc0  Text direction (BIFF8X only)</span>
                    <span class="ruby-comment cmt">#             0 = According to context</span>
                    <span class="ruby-comment cmt">#             1 = Left-to-right</span>
                    <span class="ruby-comment cmt">#             2 = Right-to-left</span>
      <span class="ruby-identifier">xf_used_attr</span>, <span class="ruby-comment cmt">#  Bit  Mask  Contents</span>
                    <span class="ruby-comment cmt">#  7-2  0xfc  XF_USED_ATTRIB – Used attributes</span>
                    <span class="ruby-comment cmt">#             Each bit describes the validity of a</span>
                    <span class="ruby-comment cmt">#             specific group of attributes. In cell XFs</span>
                    <span class="ruby-comment cmt">#             a cleared bit means the attributes of the</span>
                    <span class="ruby-comment cmt">#             parent style XF are used (but only if the</span>
                    <span class="ruby-comment cmt">#             attributes are valid there), a set bit</span>
                    <span class="ruby-comment cmt">#             means the attributes of this XF are used.</span>
                    <span class="ruby-comment cmt">#             In style XFs a cleared bit means the</span>
                    <span class="ruby-comment cmt">#             attribute setting is valid, a set bit</span>
                    <span class="ruby-comment cmt">#             means the attribute should be ignored.</span>
                    <span class="ruby-comment cmt">#             Bit  Mask  Contents</span>
                    <span class="ruby-comment cmt">#               0  0x01  Flag for number format</span>
                    <span class="ruby-comment cmt">#               1  0x02  Flag for font</span>
                    <span class="ruby-comment cmt">#               2  0x04  Flag for horizontal and</span>
                    <span class="ruby-comment cmt">#                        vertical alignment, text wrap,</span>
                    <span class="ruby-comment cmt">#                        indentation, orientation,</span>
                    <span class="ruby-comment cmt">#                        rotation, and text direction</span>
                    <span class="ruby-comment cmt">#               3  0x08  Flag for border lines</span>
                    <span class="ruby-comment cmt">#               4  0x10  Flag for background area style</span>
                    <span class="ruby-comment cmt">#               5  0x20  Flag for cell protection (cell</span>
                    <span class="ruby-comment cmt">#                        locked and formula hidden)</span>
      <span class="ruby-identifier">xf_borders</span>,   <span class="ruby-comment cmt"># Cell border lines and background area:</span>
                    <span class="ruby-comment cmt">#   Bit  Mask        Contents</span>
                    <span class="ruby-comment cmt">#  3- 0  0x0000000f  Left line style (➜ 3.10)</span>
                    <span class="ruby-comment cmt">#  7- 4  0x000000f0  Right line style (➜ 3.10)</span>
                    <span class="ruby-comment cmt"># 11- 8  0x00000f00  Top line style (➜ 3.10)</span>
                    <span class="ruby-comment cmt"># 15-12  0x0000f000  Bottom line style (➜ 3.10)</span>
                    <span class="ruby-comment cmt"># 22-16  0x007f0000  Colour index (➜ 6.70)</span>
                    <span class="ruby-comment cmt">#                    for left line colour</span>
                    <span class="ruby-comment cmt"># 29-23  0x3f800000  Colour index (➜ 6.70)</span>
                    <span class="ruby-comment cmt">#                    for right line colour</span>
                    <span class="ruby-comment cmt">#    30  0x40000000  1 = Diagonal line</span>
                    <span class="ruby-comment cmt">#                    from top left to right bottom</span>
                    <span class="ruby-comment cmt">#    31  0x80000000  1 = Diagonal line</span>
                    <span class="ruby-comment cmt">#                    from bottom left to right top</span>
      <span class="ruby-identifier">xf_brdcolors</span>, <span class="ruby-comment cmt">#   Bit  Mask        Contents</span>
                    <span class="ruby-comment cmt">#  6- 0  0x0000007f  Colour index (➜ 6.70)</span>
                    <span class="ruby-comment cmt">#                    for top line colour</span>
                    <span class="ruby-comment cmt"># 13- 7  0x00003f80  Colour index (➜ 6.70)</span>
                    <span class="ruby-comment cmt">#                    for bottom line colour</span>
                    <span class="ruby-comment cmt"># 20-14  0x001fc000  Colour index (➜ 6.70)</span>
                    <span class="ruby-comment cmt">#                    for diagonal line colour</span>
                    <span class="ruby-comment cmt"># 24-21  0x01e00000  Diagonal line style (➜ 3.10)</span>
                    <span class="ruby-comment cmt"># 31-26  0xfc000000  Fill pattern (➜ 3.11)</span>
      <span class="ruby-identifier">xf_pattern</span>    <span class="ruby-comment cmt">#   Bit  Mask        Contents</span>
                    <span class="ruby-comment cmt">#   6-0  0x007f      Colour index (➜ 6.70)</span>
                    <span class="ruby-comment cmt">#                    for pattern colour</span>
                    <span class="ruby-comment cmt">#  13-7  0x3f80      Colour index (➜ 6.70)</span>
                    <span class="ruby-comment cmt">#                    for pattern background</span>
    ]
    <span class="ruby-identifier">write_op</span> <span class="ruby-identifier">writer</span>, <span class="ruby-value">0x00e0</span>, <span class="ruby-identifier">data</span>.<span class="ruby-identifier">pack</span>(<span class="ruby-identifier">binfmt</span>(<span class="ruby-identifier">:xf</span>))
  <span class="ruby-keyword kw">end</span></pre>
</body>
</html>